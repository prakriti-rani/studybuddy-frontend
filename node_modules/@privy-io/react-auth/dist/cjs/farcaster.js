"use strict";var t=require("react"),e=require("./internal-context-DV3MljLU.js"),r=require("./paths-BGBZ-6Nl.js");require("ofetch");class i{async init(){if(!this.api)throw new e.PrivyClientError("Auth flow has no API instance");let{nonce:t}=await this.api.post(r.initFarcasterV2Path,{});return{nonce:t}}async authenticate(){if(!this.message||!this.signature||!this.fid)throw new e.PrivyClientError("Auth flow has no message, signature, or fid");if(!this.api)throw new e.PrivyClientError("Auth flow has no API instance");try{let t=await this.api.post(r.authenticateFarcasterV2Path,{message:this.message,signature:this.signature,fid:this.fid});if(!t)throw new e.PrivyClientError("No response from authentication");return t}catch(t){throw e.formatApiError(t)}}async link(){throw Error("Not implemented")}setAuthData({message:t,signature:e,fid:r}){this.message=t,this.signature=e,this.fid=r}constructor(){this.meta={}}}exports.useLoginToFrame=()=>{let{client:r,setAuthenticated:a,setUser:s}=e.usePrivyInternal();return{initLoginToFrame:t.useCallback((async()=>{let t=new i;if(!r)throw new e.PrivyClientError("Must initialize Privy client first.");return r.startAuthFlow(t),await t.init()}),[r]),loginToFrame:t.useCallback((async({message:t,signature:n})=>{if(!r)throw new e.PrivyClientError("Must initialize Privy client first.");if(!(r.authFlow instanceof i))throw new e.PrivyClientError("Must initialize Farcaster frame flow first.");let o=(t=>{let e=t.match(/farcaster:\/\/fid\/(\d+)/);return e&&e[1]?parseInt(e[1],10):null})(t);if(!o)throw new e.PrivyClientError("Invalid message format; could not parse Farcaster ID.");r.authFlow.setAuthData({message:t,signature:n,fid:o});let{user:h}=await r.authenticate();return h&&(s(h),a(!0)),h}),[r,s,a])}};
